<?xml version="1.0" encoding="UTF-8"?>
<svg width="700" height="550" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
     refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- 背景 -->
  <rect width="700" height="550" fill="#f8f9fa"/>
  
  <!-- 标题 -->
  <text x="350" y="25" font-family="Arial" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">价值迭代算法流程</text>
  
  <!-- 初始化 -->
  <ellipse cx="350" cy="70" rx="60" ry="25" fill="#4CAF50" stroke="#333" stroke-width="2"/>
  <text x="350" y="77" font-family="Arial" font-size="12" text-anchor="middle" fill="white">初始化 V₀(s) = 0</text>
  
  <!-- 价值更新 -->
  <rect x="260" y="130" width="180" height="60" fill="#2196F3" stroke="#333" stroke-width="2" rx="10"/>
  <text x="350" y="150" font-family="Arial" font-size="12" text-anchor="middle" fill="white">价值迭代更新</text>
  <text x="350" y="170" font-family="Arial" font-size="11" text-anchor="middle" fill="white">Vₖ₊₁(s) = max Σₛ' P(s'|s,a)[R(s,a,s') + γVₖ(s')]</text>
  
  <!-- 收敛判断 -->
  <polygon points="350,230 420,260 350,290 280,260" fill="#FF9800" stroke="#333" stroke-width="2"/>
  <text x="350" y="255" font-family="Arial" font-size="11" text-anchor="middle" fill="white">|Vₖ₊₁ - Vₖ| < ε ?</text>
  <text x="350" y="270" font-family="Arial" font-size="10" text-anchor="middle" fill="white">收敛判断</text>
  
  <!-- 提取最优策略 -->
  <rect x="270" y="330" width="160" height="50" fill="#9C27B0" stroke="#333" stroke-width="2" rx="10"/>
  <text x="350" y="350" font-family="Arial" font-size="12" text-anchor="middle" fill="white">提取最优策略</text>
  <text x="350" y="365" font-family="Arial" font-size="11" text-anchor="middle" fill="white">π*(s) = argmax Q*(s,a)</text>
  
  <!-- 输出结果 -->
  <ellipse cx="350" cy="430" rx="70" ry="25" fill="#F44336" stroke="#333" stroke-width="2"/>
  <text x="350" y="437" font-family="Arial" font-size="12" text-anchor="middle" fill="white">输出 V* 和 π*</text>
  
  <!-- 连接箭头 -->
  <g stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <!-- 初始化到价值更新 -->
    <line x1="350" y1="95" x2="350" y2="125"/>
    
    <!-- 价值更新到判断 -->
    <line x1="350" y1="190" x2="350" y2="225"/>
    
    <!-- 判断到提取策略(是) -->
    <line x1="350" y1="295" x2="350" y2="325"/>
    
    <!-- 判断到价值更新(否) -->
    <path d="M 280 260 L 200 260 L 200 160 L 255 160" stroke="#666" stroke-dasharray="5,5"/>
    
    <!-- 提取策略到输出 -->
    <line x1="350" y1="380" x2="350" y2="405"/>
  </g>
  
  <!-- 标签 -->
  <text x="360" y="315" font-family="Arial" font-size="10" fill="#333">是</text>
  <text x="240" y="255" font-family="Arial" font-size="10" fill="#333">否</text>
  
  <!-- 左侧：Bellman方程 -->
  <rect x="20" y="80" width="200" height="180" fill="#e8f5e8" stroke="#4CAF50" stroke-width="2" rx="10"/>
  <text x="120" y="105" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">Bellman最优方程</text>
  
  <text x="30" y="130" font-family="Arial" font-size="12" font-weight="bold" fill="#333">状态价值函数：</text>
  <text x="30" y="150" font-family="Arial" font-size="10" fill="#333">V*(s) = max Σₛ' P(s'|s,a)</text>
  <text x="30" y="165" font-family="Arial" font-size="10" fill="#333">        [R(s,a,s') + γV*(s')]</text>
  
  <text x="30" y="190" font-family="Arial" font-size="12" font-weight="bold" fill="#333">动作价值函数：</text>
  <text x="30" y="210" font-family="Arial" font-size="10" fill="#333">Q*(s,a) = Σₛ' P(s'|s,a)</text>
  <text x="30" y="225" font-family="Arial" font-size="10" fill="#333">          [R(s,a,s') + γV*(s')]</text>
  
  <text x="30" y="245" font-family="Arial" font-size="10" fill="#666">其中 γ ∈ [0,1) 为折扣因子</text>
  
  <!-- 右侧：算法特点 -->
  <rect x="480" y="80" width="200" height="360" fill="#fff3e0" stroke="#FF9800" stroke-width="2" rx="10"/>
  <text x="580" y="105" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">算法特点</text>
  
  <text x="490" y="130" font-family="Arial" font-size="12" font-weight="bold" fill="#2196F3">1. 收敛性</text>
  <text x="490" y="150" font-family="Arial" font-size="10" fill="#333">• 保证收敛到最优价值函数V*</text>
  <text x="490" y="165" font-family="Arial" font-size="10" fill="#333">• 收敛速度：线性收敛</text>
  <text x="490" y="180" font-family="Arial" font-size="10" fill="#333">• 误差界限：||Vₖ - V*|| ≤ γᵏ||V₀ - V*||</text>
  
  <text x="490" y="205" font-family="Arial" font-size="12" font-weight="bold" fill="#FF9800">2. 计算复杂度</text>
  <text x="490" y="225" font-family="Arial" font-size="10" fill="#333">• 每次迭代：O(|S|²|A|)</text>
  <text x="490" y="240" font-family="Arial" font-size="10" fill="#333">• 总复杂度：取决于收敛轮数</text>
  <text x="490" y="255" font-family="Arial" font-size="10" fill="#333">• 空间复杂度：O(|S|)</text>
  
  <text x="490" y="280" font-family="Arial" font-size="12" font-weight="bold" fill="#9C27B0">3. 与策略迭代比较</text>
  <text x="490" y="300" font-family="Arial" font-size="10" fill="#333">• 无需维护显式策略</text>
  <text x="490" y="315" font-family="Arial" font-size="10" fill="#333">• 每轮计算量更小</text>
  <text x="490" y="330" font-family="Arial" font-size="10" fill="#333">• 可能需要更多迭代轮数</text>
  
  <text x="490" y="355" font-family="Arial" font-size="12" font-weight="bold" fill="#F44336">4. 实际应用</text>
  <text x="490" y="375" font-family="Arial" font-size="10" fill="#333">• 适用于大状态空间</text>
  <text x="490" y="390" font-family="Arial" font-size="10" fill="#333">• 易于并行化实现</text>
  <text x="490" y="405" font-family="Arial" font-size="10" fill="#333">• 可与函数逼近结合</text>
  <text x="490" y="420" font-family="Arial" font-size="10" fill="#333">• 在线学习中的基础</text>
  
  <!-- 底部：收敛示例 -->
  <rect x="20" y="280" width="440" height">填</rect>
  <text x="240" y="305" font-family="Arial" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">价值函数收敛过程</text>
  
  <!-- 坐标轴 -->
  <line x1="50" y1="460" x2="430" y2="460" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="50" y1="320" x2="50" y2="460" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <text x="440" y="465" font-family="Arial" font-size="12" fill="#333">迭代次数</text>
  <text x="40" y="315" font-family="Arial" font-size="12" fill="#333">价值</text>
  
  <!-- 收敛曲线 -->
  <path d="M 70 440 Q 150 380 250 350 Q 350 335 410 330" stroke="#2196F3" stroke-width="3" fill="none"/>
  
  <!-- 最优价值线 -->
  <line x1="70" y1="330" x2="410" y2="330" stroke="#F44336" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="420" y="335" font-family="Arial" font-size="10" fill="#F44336">V*</text>
  
  <!-- 刻度 -->
  <g font-family="Arial" font-size="10" fill="#666">
    <line x1="70" y1="455" x2="70" y2="465" stroke="#666"/>
    <text x="70" y="480" text-anchor="middle">0</text>
    
    <line x1="150" y1="455" x2="150" y2="465" stroke="#666"/>
    <text x="150" y="480" text-anchor="middle">5</text>
    
    <line x1="250" y1="455" x2="250" y2="465" stroke="#666"/>
    <text x="250" y="480" text-anchor="middle">10</text>
    
    <line x1="350" y1="455" x2="350" y2="465" stroke="#666"/>
    <text x="350" y="480" text-anchor="middle">15</text>
    
    <line x1="410" y1="455" x2="410" y2="465" stroke="#666"/>
    <text x="410" y="480" text-anchor="middle">20</text>
  </g>
  
  <text x="240" y="500" font-family="Arial" font-size="11" text-anchor="middle" fill="#666">价值迭代算法的收敛过程，逐步逼近最优价值函数</text>
  
</svg>
